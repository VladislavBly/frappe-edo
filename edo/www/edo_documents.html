{% extends "templates/web.html" %}

{% block title %}{{ _("EDO Documents") }}{% endblock %}

{% block head_include %}
{% if css_files %}
	{% for css_file in css_files %}
	<link rel="stylesheet" href="/assets/edo/dist/{{ css_file }}">
	{% endfor %}
{% endif %}
<style>
	/* Скрыть все элементы Frappe */
	.navbar,
	.web-footer,
	footer,
	.web-sidebar,
	.sidebar-column {
		display: none !important;
	}

	/* Убрать ограничения контейнеров Frappe (вне #root) */
	body > .container,
	body > .container-fluid,
	.main-section,
	.page_content,
	.page-content-wrapper,
	.from-markdown,
	.web-content {
		max-width: 100% !important;
		width: 100% !important;
		margin: 0 !important;
		padding: 0 !important;
	}

	/* Frappe row/col вне #root */
	body > .row,
	.page-content-wrapper > .row,
	.main-section > .row {
		margin: 0 !important;
	}

	.page-content-wrapper .col,
	.page-content-wrapper [class*="col-"] {
		padding: 0 !important;
		max-width: 100% !important;
		flex: 0 0 100% !important;
	}

	/*
	 * #root - контейнер React приложения
	 */
	/* Убрать скролл на body */
	html, body {
		overflow: hidden !important;
		margin: 0 !important;
		padding: 0 !important;
	}

	#root {
		position: fixed !important;
		top: 0 !important;
		left: 0 !important;
		right: 0 !important;
		bottom: 0 !important;
		width: 100% !important;
		height: 100% !important;
		margin: 0 !important;
		padding: 0 !important;
		overflow: hidden !important;
		font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
		line-height: 1.5 !important;
		-webkit-font-smoothing: antialiased !important;
		-moz-osx-font-smoothing: grayscale !important;
		background-color: white !important;
		/* CSS переменные для Tailwind */
		--radius: 0.5rem;
		--background: 0 0% 100%;
		--foreground: 222.2 84% 4.9%;
		--card: 0 0% 100%;
		--card-foreground: 222.2 84% 4.9%;
		--popover: 0 0% 100%;
		--popover-foreground: 222.2 84% 4.9%;
		--primary: 221.2 83.2% 53.3%;
		--primary-foreground: 210 40% 98%;
		--secondary: 210 40% 96.1%;
		--secondary-foreground: 222.2 47.4% 11.2%;
		--muted: 210 40% 96.1%;
		--muted-foreground: 215.4 16.3% 46.9%;
		--accent: 210 40% 96.1%;
		--accent-foreground: 222.2 47.4% 11.2%;
		--destructive: 0 84.2% 60.2%;
		--destructive-foreground: 210 40% 98%;
		--border: 214.3 31.8% 91.4%;
		--input: 214.3 31.8% 91.4%;
		--ring: 221.2 83.2% 53.3%;
	}

	/* box-sizing для всех элементов внутри #root */
	#root *,
	#root *::before,
	#root *::after {
		box-sizing: border-box;
	}

	/*
	 * Переопределяем ТОЛЬКО конфликтующие Bootstrap классы
	 * Используем точные имена классов Bootstrap, а не wildcard селекторы
	 */

	/* Bootstrap .bg-primary конфликтует с Tailwind .bg-primary */
	#root .bg-primary {
		background-color: hsl(221.2 83.2% 53.3%) !important;
	}
	#root .bg-secondary {
		background-color: hsl(210 40% 96.1%) !important;
	}
	#root .bg-white {
		background-color: white !important;
	}

	/* Bootstrap .text-primary конфликтует с Tailwind */
	#root .text-primary {
		color: hsl(221.2 83.2% 53.3%) !important;
	}
	#root .text-secondary {
		color: hsl(210 40% 96.1%) !important;
	}
	#root .text-white {
		color: white !important;
	}
	#root .text-muted {
		color: hsl(215.4 16.3% 46.9%) !important;
	}

	/* Bootstrap border colors */
	#root .border-primary {
		border-color: hsl(221.2 83.2% 53.3%) !important;
	}

	/* Tailwind foreground классы */
	#root .text-primary-foreground {
		color: hsl(210 40% 98%) !important;
	}
	#root .text-muted-foreground {
		color: hsl(215.4 16.3% 46.9%) !important;
	}
	#root .text-foreground {
		color: hsl(222.2 84% 4.9%) !important;
	}

	/* Tailwind bg классы с CSS переменными */
	#root .bg-background {
		background-color: hsl(0 0% 100%) !important;
	}
	#root .bg-muted {
		background-color: hsl(210 40% 96.1%) !important;
	}
	#root .bg-card {
		background-color: hsl(0 0% 100%) !important;
	}
	#root .bg-destructive {
		background-color: hsl(0 84.2% 60.2%) !important;
	}

	/* Border */
	#root .border-border {
		border-color: hsl(214.3 31.8% 91.4%) !important;
	}
</style>
{% endblock %}

{% block page_content %}
<div id="root">
	<div style="display: flex; align-items: center; justify-content: center; min-height: 400px;">
		<div style="text-align: center;">
			<h2>Загрузка...</h2>
		</div>
	</div>
</div>

{% if js_file %}
<script type="module" src="/assets/edo/dist/{{ js_file }}"></script>
{% else %}
<script>
	document.getElementById('root').innerHTML = '<div style="padding: 2rem; text-align: center;"><h2>Ошибка загрузки приложения</h2><p>Пожалуйста, пересоберите фронтенд командой:<br><code>cd frontend && yarn build</code></p></div>';
</script>
{% endif %}
{% endblock %}
